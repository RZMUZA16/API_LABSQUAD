// ============================================
// Prisma Schema - Sistem Poin Lab & Sertifikat
// ============================================

// Prisma Client Generator
generator client {
  provider = "prisma-client-js"
}

// Database Connection
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ============================================
// ENUM
// ============================================
enum status_sertifikat {
  Menunggu
  Diterima
  Ditolak
}

enum user_role {
  MAHASISWA
  DOSEN
  KAPLAB
  ADMIN
}
model User {
  id          Int           @id @default(autoincrement())
  nama        String
  email       String        @unique
  password    String
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  // Relasi
  sertifikat  sertifikat[]
  poinLab     PoinLab[]
}

model sertifikat {
  id             Int        @id @default(autoincrement())
  nama           String
  deskripsi      String?
  userId         Int?
  createdAt      DateTime   @default(now())

  // Relasi balik
  user           User?      @relation(fields: [userId], references: [id])
  sertifikatActivities sertifikat_activity[]
}

model PoinLab {
  id             Int         @id @default(autoincrement())
  studentId      Int?
  activityId     Int?
  poin           Int
  createdAt      DateTime    @default(now())

  // Relasi balik
  user           User?       @relation(fields: [studentId], references: [id])
  activity       activity?   @relation(fields: [activityId], references: [id])
}

model activity {
  id                    Int                  @id @default(autoincrement())
  nama_activity         String
  deskripsi_activity    String?
  poin_default          Int                  @default(0)
  is_active             Boolean              @default(true)
  createdAt             DateTime             @default(now())
  updatedAt             DateTime             @updatedAt

  // Relasi
  sertifikatActivities  sertifikat_activity[]
  poinLab               PoinLab[]
}

model sertifikat_activity {
  id             Int           @id @default(autoincrement())
  sertifikatId   Int
  activityId     Int

  sertifikat     sertifikat    @relation(fields: [sertifikatId], references: [id])
  activity       activity      @relation(fields: [activityId], references: [id])
}
